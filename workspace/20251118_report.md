# ADMET ì˜ˆì¸¡ ëª¨ë¸ ìµœì¢… í•™ìŠµ ë³´ê³ ì„œ

**ì‘ì„±ì¼:** 2025ë…„ 11ì›” 18ì¼  
**ì‘ì„±ì:** ìµœì¤€í•˜ (Junha Choi)  
**í”„ë¡œì íŠ¸:** 33ê°œ ADMET ì†ì„± ì˜ˆì¸¡ í†µí•© ëª¨ë¸ ê°œë°œ  

---

## ëª©ì°¨
1. [ì—°êµ¬ ê°œìš”](#1-ì—°êµ¬-ê°œìš”)
2. [ì‹¤í—˜ í™˜ê²½](#2-ì‹¤í—˜-í™˜ê²½)
3. [ë°ì´í„°ì…‹](#3-ë°ì´í„°ì…‹)
4. [ëª¨ë¸ ì•„í‚¤í…ì²˜](#4-ëª¨ë¸-ì•„í‚¤í…ì²˜)
5. [í•™ìŠµ ì „ëµ](#5-í•™ìŠµ-ì „ëµ)
6. [ì„±ëŠ¥ ê²°ê³¼](#6-ì„±ëŠ¥-ê²°ê³¼)
7. [ë¶„í¬ ë¶„ì„](#7-ë¶„í¬-ë¶„ì„)
8. [ì£¼ìš” ë°œê²¬ì‚¬í•­](#8-ì£¼ìš”-ë°œê²¬ì‚¬í•­)
9. [ë°°í¬ ì‹œìŠ¤í…œ](#9-ë°°í¬-ì‹œìŠ¤í…œ)
10. [ê²°ë¡  ë° í–¥í›„ ê³¼ì œ](#10-ê²°ë¡ -ë°-í–¥í›„-ê³¼ì œ)

---

## 1. ì—°êµ¬ ê°œìš”

### 1.1 ì—°êµ¬ ëª©ì 
ì•½ë¬¼ ê°œë°œ ì´ˆê¸° ë‹¨ê³„ì—ì„œ ADMET (Absorption, Distribution, Metabolism, Excretion, Toxicity) ì†ì„±ì„ ì •í™•í•˜ê²Œ ì˜ˆì¸¡í•˜ì—¬ ì•½ë¬¼ í›„ë³´ ë¬¼ì§ˆì˜ ì„±ê³µ ê°€ëŠ¥ì„±ì„ í‰ê°€í•˜ê³ , ê°œë°œ ë¹„ìš©ê³¼ ì‹œê°„ì„ ì ˆê°í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•¨.

### 1.2 ì—°êµ¬ ë²”ìœ„
- **33ê°œ ADMET ì†ì„±** ì˜ˆì¸¡ ëª¨ë¸ ê°œë°œ
  - ë¶„ë¥˜ ëª¨ë¸: 21ê°œ (ì´ì§„ ë¶„ë¥˜)
  - íšŒê·€ ëª¨ë¸: 12ê°œ (ì—°ì†í˜• ì˜ˆì¸¡)
- **ì¹´í…Œê³ ë¦¬ë³„ ë¶„í¬**:
  - Absorption (í¡ìˆ˜): 8ê°œ ì†ì„±
  - Distribution (ë¶„í¬): 3ê°œ ì†ì„±
  - Metabolism (ëŒ€ì‚¬): 8ê°œ ì†ì„±
  - Excretion (ë°°ì„¤): 3ê°œ ì†ì„±
  - Toxicity (ë…ì„±): 11ê°œ ì†ì„±

### 1.3 ì£¼ìš” ì„±ê³¼
- âœ… 33ê°œ ìµœì¢… ëª¨ë¸ í•™ìŠµ ì™„ë£Œ
- âœ… í†µí•© ì˜ˆì¸¡ ì‹œìŠ¤í…œ êµ¬ì¶• (ë‹¨ì¼ SMILES â†’ 33ê°œ ì†ì„± ë™ì‹œ ì˜ˆì¸¡)
- âœ… í‰ê·  AUROC 80.35% (ë¶„ë¥˜), RÂ² 0.29 (íšŒê·€)
- âœ… ìµœê³  ì„±ëŠ¥: HIA_Hou 95.88% AUROC

---

## 2. ì‹¤í—˜ í™˜ê²½

### 2.1 í•˜ë“œì›¨ì–´ êµ¬ì„±
```
GPU: 4Ã— NVIDIA RTX A5000 (24GB VRAM each)
CPU: 64 cores (32 physical cores with hyperthreading)
RAM: 256GB
GPU Driver: NVIDIA 535.230.02
Storage: NVMe SSD (ê³ ì† ë°ì´í„° ë¡œë”©)
```

### 2.2 ì†Œí”„íŠ¸ì›¨ì–´ ìŠ¤íƒ
```python
Python: 3.11.13
PyTorch: 2.8.0
PyTorch Geometric: 2.6.1
CUDA: 12.8
RDKit: 2023.03.3
ìš´ì˜ì²´ì œ: Linux (Ubuntu 20.04)
```

### 2.3 ë³‘ë ¬ í•™ìŠµ í™˜ê²½
- **GPU í• ë‹¹**: 4ê°œ GPUì— ìˆœì°¨ì  ì‘ì—… ë¶„ë°°
- **í•™ìŠµ ì‹œê°„**: ì´ 3-6ì‹œê°„ (33ê°œ ëª¨ë¸ ë³‘ë ¬ ì‹¤í–‰)
- **GPU í™œìš©ë¥ **: í‰ê·  3-70% (ë°ì´í„°ì…‹ í¬ê¸°ì— ë”°ë¼ ë³€ë™)

---

## 3. ë°ì´í„°ì…‹

### 3.1 ë°ì´í„° ê°œìš”

#### 3.1.1 ì´ ë°ì´í„° ê·œëª¨
- **ì´ í™”í•©ë¬¼ ìˆ˜**: ~600,000ê°œ (ì¤‘ë³µ ì œê±° í›„)
- **ì´ ë°ì´í„° ìš©ëŸ‰**: 4.2GB
- **ë°ì´í„° í˜•ì‹**: CSV (SMILES, target label/value)

#### 3.1.2 ì¹´í…Œê³ ë¦¬ë³„ ë°ì´í„°ì…‹

**Absorption (í¡ìˆ˜, 8ê°œ ë°ì´í„°ì…‹)**
| ë°ì´í„°ì…‹ | íƒ€ì… | ìƒ˜í”Œ ìˆ˜ | ì„¤ëª… |
|---------|------|---------|------|
| Bioavailability_Ma | ë¶„ë¥˜ | 640 | ìƒë¬¼í•™ì  ì´ìš©ë¥  |
| Caco2_Wang | íšŒê·€ | 910 | Caco-2 ì„¸í¬ íˆ¬ê³¼ì„± |
| HIA_Hou | ë¶„ë¥˜ | 578 | ì‚¬ëŒ ì¥ í¡ìˆ˜ |
| HydrationFreeEnergy_FreeSolv | íšŒê·€ | 642 | ìˆ˜í™” ììœ  ì—ë„ˆì§€ |
| Lipophilicity_AstraZeneca | íšŒê·€ | 4,200 | ì¹œìœ ì„± (LogP) |
| PAMPA_NCATS | ë¶„ë¥˜ | 2,035 | PAMPA íˆ¬ê³¼ì„± |
| Pgp_Broccatelli | ë¶„ë¥˜ | 1,212 | P-glycoprotein ê¸°ì§ˆ |
| Solubility_AqSolDB | íšŒê·€ | 9,982 | ìˆ˜ìš©ì„± |

**Distribution (ë¶„í¬, 3ê°œ ë°ì´í„°ì…‹)**
| ë°ì´í„°ì…‹ | íƒ€ì… | ìƒ˜í”Œ ìˆ˜ | ì„¤ëª… |
|---------|------|---------|------|
| BBB_Martins | ë¶„ë¥˜ | 1,975 | í˜ˆì•¡-ë‡Œ ì¥ë²½ íˆ¬ê³¼ |
| PPBR_AZ | íšŒê·€ | 1,614 | í˜ˆì¥ ë‹¨ë°±ì§ˆ ê²°í•©ë¥  |
| VDss_Lombardo | íšŒê·€ | 1,130 | ë¶„í¬ ìš©ì  |

**Metabolism (ëŒ€ì‚¬, 8ê°œ ë°ì´í„°ì…‹)**
| ë°ì´í„°ì…‹ | íƒ€ì… | ìƒ˜í”Œ ìˆ˜ | ì„¤ëª… |
|---------|------|---------|------|
| CYP1A2_Veith | ë¶„ë¥˜ | 12,092 | CYP1A2 ì–µì œ |
| CYP2C19_Veith | ë¶„ë¥˜ | 12,664 | CYP2C19 ì–µì œ |
| CYP2C9_Substrate_CarbonMangels | ë¶„ë¥˜ | 666 | CYP2C9 ê¸°ì§ˆ |
| CYP2C9_Veith | ë¶„ë¥˜ | 12,092 | CYP2C9 ì–µì œ |
| CYP2D6_Substrate_CarbonMangels | ë¶„ë¥˜ | 664 | CYP2D6 ê¸°ì§ˆ |
| CYP2D6_Veith | ë¶„ë¥˜ | 13,130 | CYP2D6 ì–µì œ |
| CYP3A4_Substrate_CarbonMangels | ë¶„ë¥˜ | 667 | CYP3A4 ê¸°ì§ˆ |
| CYP3A4_Veith | ë¶„ë¥˜ | 12,328 | CYP3A4 ì–µì œ |

**Excretion (ë°°ì„¤, 3ê°œ ë°ì´í„°ì…‹)**
| ë°ì´í„°ì…‹ | íƒ€ì… | ìƒ˜í”Œ ìˆ˜ | ì„¤ëª… |
|---------|------|---------|------|
| Clearance_Hepatocyte_AZ | íšŒê·€ | 1,213 | ê°„ì„¸í¬ ì œê±°ìœ¨ |
| Clearance_Microsome_AZ | íšŒê·€ | 1,102 | ë¯¸ì†Œì²´ ì œê±°ìœ¨ |
| Half_Life_Obach | íšŒê·€ | 667 | ë°˜ê°ê¸° |

**Toxicity (ë…ì„±, 11ê°œ ë°ì´í„°ì…‹)**
| ë°ì´í„°ì…‹ | íƒ€ì… | ìƒ˜í”Œ ìˆ˜ | ì„¤ëª… |
|---------|------|---------|------|
| AMES | ë¶„ë¥˜ | 7,255 | ëŒì—°ë³€ì´ ìœ ë°œì„± |
| Carcinogens_Lagunin | ë¶„ë¥˜ | 278 | ë°œì•”ì„± |
| ClinTox | ë¶„ë¥˜ | 1,478 | ì„ìƒ ë…ì„± |
| DILI | ë¶„ë¥˜ | 475 | ì•½ë¬¼ ìœ ë°œ ê°„ì†ìƒ |
| hERG | ë¶„ë¥˜ | 655 | hERG ì–µì œ |
| hERG_Central_10uM | íšŒê·€ | 306,893 | hERG IC50 (10Î¼M) |
| hERG_Central_1uM | íšŒê·€ | 306,893 | hERG IC50 (1Î¼M) |
| hERG_Central_inhib | ë¶„ë¥˜ | 13,445 | hERG ì–µì œ (ì¤‘ì•™) |
| hERG_Karim | ë¶„ë¥˜ | 7,889 | hERG ì‹¬ì¥ë…ì„± |
| LD50_Zhu | íšŒê·€ | 7,385 | ê¸‰ì„± ë…ì„± (ë°˜ìˆ˜ì¹˜ì‚¬ëŸ‰) |
| Skin_Reaction | ë¶„ë¥˜ | 404 | í”¼ë¶€ ë°˜ì‘ |

### 3.2 ë°ì´í„° ì „ì²˜ë¦¬

#### 3.2.1 ë¶„ì ê·¸ë˜í”„ ë³€í™˜
```python
# SMILES â†’ RDKit Mol â†’ PyTorch Geometric Data
íŠ¹ì§• (Node Features):
  - Atomic number (ì›ì ë²ˆí˜¸)
  - Chirality (í‚¤ë„ì„±)
  - Degree (ê²°í•© ì°¨ìˆ˜)
  - Formal charge (í˜•ì‹ ì „í•˜)
  - Number of hydrogens (ìˆ˜ì†Œ ê°œìˆ˜)
  - Hybridization (í˜¼ì„± ê¶¤ë„)
  - Aromaticity (ë°©í–¥ì¡±ì„±)

íŠ¹ì§• (Edge Features):
  - Bond type (ê²°í•© ìœ í˜•: ë‹¨ì¼/ì´ì¤‘/ì‚¼ì¤‘/ë°©í–¥ì¡±)
  - Bond direction (ê²°í•© ë°©í–¥)
  - Ring membership (ê³ ë¦¬ í¬í•¨ ì—¬ë¶€)
  - Conjugation (ê³µì•¡ ì—¬ë¶€)
```

#### 3.2.2 ë°ì´í„° ë¶„í• 
- **ë¶„í•  ë°©ë²•**: Random split (ë¬´ì‘ìœ„ ë¶„í• )
- **ë¹„ìœ¨**: Train 70% / Validation 10% / Test 20%
- **ìµœì¢… í•™ìŠµ**: Train + Validation ê²°í•© (80%)
- **Seed**: 42 (ì¬í˜„ì„± ë³´ì¥)

---

## 4. ëª¨ë¸ ì•„í‚¤í…ì²˜

### 4.1 GNN_topexpert êµ¬ì¡°

```
ì…ë ¥: ë¶„ì ê·¸ë˜í”„ (SMILES)
  â†“
[ì‚¬ì „í•™ìŠµ GIN Encoder]
  - 5 layers
  - 300-dim embeddings
  - supervised_contextpred.pth
  â†“
[TopExpert Module]
  - 7 experts
  - Scaffold-based expert assignment
  - Gumbel-Softmax gating (temp: 10.0â†’1.0)
  â†“
[Task-specific Head]
  - Classification: BCEWithLogitsLoss
  - Regression: L1Loss (MAE)
  â†“
ì¶œë ¥: ì˜ˆì¸¡ ê°’ (í™•ë¥  or ì—°ì†ê°’)
```

### 4.2 í•µì‹¬ êµ¬ì„± ìš”ì†Œ

#### 4.2.1 GIN (Graph Isomorphism Network)
```python
NUM_LAYER = 5
EMB_DIM = 300
DROPOUT_RATIO = 0.0
GRAPH_POOLING = 'mean'
JK = 'last'  # Jumping Knowledge
```

#### 4.2.2 TopExpert (Mixture of Experts)
```python
NUM_EXPERTS = 7
GATE_DIM = 64
ALPHA = 0.1  # í´ëŸ¬ìŠ¤í„°ë§ ì†ì‹¤ ê°€ì¤‘ì¹˜
BETA = 0.1   # ì •ë ¬ ì†ì‹¤ ê°€ì¤‘ì¹˜
```

#### 4.2.3 ì˜¨ë„ ì–´ë‹ë§ (Temperature Annealing)
```python
INIT_TEMP = 10.0  # ì´ˆê¸° ì˜¨ë„ (soft assignment)
MIN_TEMP = 1.0    # ìµœì¢… ì˜¨ë„ (hard assignment)
# í•™ìŠµ ì¤‘ ì§€ìˆ˜ì  ê°ì†Œ
```

### 4.3 ì‚¬ì „ í•™ìŠµ ëª¨ë¸
- **ì¶œì²˜**: Stanford SNAP Group
- **ëª¨ë¸**: supervised_contextpred.pth
- **ì‚¬ì „í•™ìŠµ ë°ì´í„°**: ~250ë§Œ ê°œ ë¶„ì ê·¸ë˜í”„
- **í•™ìŠµ ëª©í‘œ**: Context prediction (ë¶„ì êµ¬ì¡° ì˜ˆì¸¡)

---

## 5. í•™ìŠµ ì „ëµ

### 5.1 í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹

#### 5.1.1 Grid Search ë²”ìœ„
```python
learning_rate: [1e-5, 1e-4, 1e-3]
batch_size: [8, 16, 32, 64, 128, 256, 512]
epochs: [100, 200, 500, 1000, 5000, 10000]  # taskë³„ ì°¨ë“±
num_layer: [3, 5, 7]
emb_dim: [300]  # ì‚¬ì „í•™ìŠµ ëª¨ë¸ ê³ ì •
dropout: [0.0, 0.1, 0.3, 0.5]
```

#### 5.1.2 ìµœì  í•˜ì´í¼íŒŒë¼ë¯¸í„° ì„ ì •
- **ë¶„ë¥˜ íƒœìŠ¤í¬**: AUROC ìµœëŒ€í™”
- **íšŒê·€ íƒœìŠ¤í¬**: MAE ìµœì†Œí™”
- **ê²°ê³¼ ì €ì¥**: `configs/best_hyperparameters_final.json`

### 5.2 ìµœì¢… í•™ìŠµ ì„¤ì •

#### 5.2.1 ë°ì´í„° ì‚¬ìš©
```python
Training Data: Train (70%) + Validation (10%) = 80%
Evaluation Data: Test (20%)
Early Stopping: Patience 50 (train+valid loss ê¸°ì¤€)
```

#### 5.2.2 ì†ì‹¤ í•¨ìˆ˜
```python
# ë¶„ë¥˜
criterion = BCEWithLogitsLoss(reduction="none")

# íšŒê·€
criterion = L1Loss(reduction="none")  # MAE

# TopExpert ì¶”ê°€ ì†ì‹¤
total_loss = task_loss + Î± Ã— cluster_loss + Î² Ã— align_loss
```

#### 5.2.3 ìµœì í™”
```python
optimizer = Adam(params, lr=lr, weight_decay=0.0001)
scheduler = None  # ê³ ì • í•™ìŠµë¥  ì‚¬ìš©
```

### 5.3 í‰ê°€ ë©”íŠ¸ë¦­

#### 5.3.1 ë¶„ë¥˜ íƒœìŠ¤í¬
```python
ì£¼ ë©”íŠ¸ë¦­: AUROC (Area Under ROC Curve)
ë³´ì¡° ë©”íŠ¸ë¦­: 
  - Accuracy
  - F1 Score (threshold=0.5)
  - Precision / Recall
```

#### 5.3.2 íšŒê·€ íƒœìŠ¤í¬
```python
ì£¼ ë©”íŠ¸ë¦­: MAE (Mean Absolute Error)
ë³´ì¡° ë©”íŠ¸ë¦­:
  - RÂ² (Coefficient of Determination)
  - RMSE (Root Mean Squared Error)
  - Pearson correlation
```

---

## 6. ì„±ëŠ¥ ê²°ê³¼

### 6.1 ì „ì²´ ì„±ëŠ¥ ìš”ì•½

#### 6.1.1 ë¶„ë¥˜ ëª¨ë¸ (21ê°œ)
```
í‰ê·  AUROC: 80.35 Â± 8.48%
ìµœê³  ì„±ëŠ¥: HIA_Hou (95.88%)
ìµœì € ì„±ëŠ¥: CYP2C9_Substrate_CarbonMangels (57.89%)
```

#### 6.1.2 íšŒê·€ ëª¨ë¸ (12ê°œ)
```
í‰ê·  RÂ²: 0.29 Â± 0.28
ìµœê³  RÂ²: HydrationFreeEnergy_FreeSolv (0.76)
ìµœì € RÂ²: Half_Life_Obach (-2.12)
```

### 6.2 ì¹´í…Œê³ ë¦¬ë³„ ìƒì„¸ ì„±ëŠ¥

#### 6.2.1 Absorption (í¡ìˆ˜)

**ë¶„ë¥˜ ëª¨ë¸**
| ë°ì´í„°ì…‹ | AUROC | Std | ìˆœìœ„ |
|---------|-------|-----|------|
| HIA_Hou | 95.88% | Â±1.20% | ğŸ¥‡ |
| PAMPA_NCATS | 90.00% | Â±1.93% | ğŸ¥ˆ |
| Pgp_Broccatelli | 88.44% | Â±1.74% | ğŸ¥‰ |
| BBB_Martins* | 86.84% | Â±2.51% | 4ìœ„ |
| Bioavailability_Ma | 63.74% | Â±5.73% | 5ìœ„ |

*BBB_MartinsëŠ” Distribution ì¹´í…Œê³ ë¦¬ì´ë‚˜ í¡ìˆ˜ ê´€ë ¨ì„±ìœ¼ë¡œ í•¨ê»˜ í‘œì‹œ

**íšŒê·€ ëª¨ë¸**
| ë°ì´í„°ì…‹ | MAE | RÂ² | í‰ê°€ |
|---------|-----|----|----|
| HydrationFreeEnergy_FreeSolv | 1.851 | 0.76 | â­ ìš°ìˆ˜ |
| Solubility_AqSolDB | 1.203 | 0.71 | â­ ìš°ìˆ˜ |
| Lipophilicity_AstraZeneca | 0.728 | 0.56 | âœ“ ì–‘í˜¸ |
| Caco2_Wang | 0.583 | 0.13 | â–³ ë³´í†µ |

**ì¹´í…Œê³ ë¦¬ í‰ê· **: AUROC 84.98 Â± 12.47%

#### 6.2.2 Distribution (ë¶„í¬)

**ë¶„ë¥˜ ëª¨ë¸**
| ë°ì´í„°ì…‹ | AUROC | í‰ê°€ |
|---------|-------|------|
| BBB_Martins | 86.84% | âœ“ ìš°ìˆ˜ |

**íšŒê·€ ëª¨ë¸**
| ë°ì´í„°ì…‹ | MAE | RÂ² | í‰ê°€ |
|---------|-----|----|----|
| PPBR_AZ | 9.832 | 0.25 | â–³ ë³´í†µ |
| VDss_Lombardo | 0.633 | -0.08 | âœ— ê°œì„  í•„ìš” |

**ì¹´í…Œê³ ë¦¬ í‰ê· **: RÂ² 0.09 Â± 0.23

#### 6.2.3 Metabolism (ëŒ€ì‚¬)

**ë¶„ë¥˜ ëª¨ë¸**
| ë°ì´í„°ì…‹ | AUROC | í‰ê°€ |
|---------|-------|------|
| CYP3A4_Veith | 78.74% | âœ“ ì–‘í˜¸ |
| CYP1A2_Veith | 77.69% | âœ“ ì–‘í˜¸ |
| CYP2C9_Veith | 76.46% | âœ“ ì–‘í˜¸ |
| CYP2D6_Veith | 74.23% | â–³ ë³´í†µ |
| CYP2D6_Substrate_CarbonMangels | 68.63% | â–³ ë³´í†µ |
| CYP3A4_Substrate_CarbonMangels | 63.78% | â–³ ë³´í†µ |
| CYP2C9_Substrate_CarbonMangels | 57.89% | âœ— ê°œì„  í•„ìš” |
| CYP2C19_Veith | 76.30% | âœ“ ì–‘í˜¸ |

**ì¹´í…Œê³ ë¦¬ í‰ê· **: AUROC 71.06 Â± 7.66%

**ë¶„ì„**: Substrate ì˜ˆì¸¡ì´ Inhibitor ì˜ˆì¸¡ë³´ë‹¤ ì–´ë ¤ì›€ (ë°ì´í„° ë¶€ì¡± ì¶”ì •)

#### 6.2.4 Excretion (ë°°ì„¤)

**íšŒê·€ ëª¨ë¸**
| ë°ì´í„°ì…‹ | MAE | RÂ² | í‰ê°€ |
|---------|-----|----|----|
| Clearance_Hepatocyte_AZ | 38.654 | -0.19 | âœ— ë¶ˆëŸ‰ |
| Clearance_Microsome_AZ | 34.949 | -0.19 | âœ— ë¶ˆëŸ‰ |
| Half_Life_Obach | 27.584 | -2.12 | âœ— ë§¤ìš° ë¶ˆëŸ‰ |

**ì¹´í…Œê³ ë¦¬ í‰ê· **: RÂ² -0.83 Â± 1.11

**ë¶„ì„**: ë°°ì„¤ ê´€ë ¨ ì†ì„±ì€ ë³µì¡í•œ ìƒë¦¬í•™ì  ê³¼ì •ìœ¼ë¡œ ì˜ˆì¸¡ ë‚œì´ë„ ë†’ìŒ

#### 6.2.5 Toxicity (ë…ì„±)

**ë¶„ë¥˜ ëª¨ë¸**
| ë°ì´í„°ì…‹ | AUROC | í‰ê°€ |
|---------|-------|------|
| ClinTox | 88.61% | â­ ìš°ìˆ˜ |
| DILI | 84.63% | âœ“ ì–‘í˜¸ |
| AMES | 80.74% | âœ“ ì–‘í˜¸ |
| hERG | 80.89% | âœ“ ì–‘í˜¸ |
| hERG_Karim | 78.35% | âœ“ ì–‘í˜¸ |
| hERG_Central_inhib | 70.85% | â–³ ë³´í†µ |
| Carcinogens_Lagunin | 70.38% | â–³ ë³´í†µ |
| Skin_Reaction | 68.75% | â–³ ë³´í†µ |

**íšŒê·€ ëª¨ë¸**
| ë°ì´í„°ì…‹ | MAE | RÂ² | í‰ê°€ |
|---------|-----|----|----|
| LD50_Zhu | 0.569 | 0.62 | â­ ìš°ìˆ˜ |
| hERG_Central_10uM | 14.827 | 0.47 | âœ“ ì–‘í˜¸ |
| hERG_Central_1uM | 8.084 | 0.46 | âœ“ ì–‘í˜¸ |

**ì¹´í…Œê³ ë¦¬ í‰ê· **: AUROC 78.02 Â± 7.09%, RÂ² 0.52 Â± 0.08

### 6.3 ìµœì¢… í•™ìŠµ vs íŠœë‹ ë¹„êµ

#### 6.3.1 ì „ì²´ í†µê³„
```
ê°œì„ ëœ ëª¨ë¸: 15ê°œ (45.5%)
ì•…í™”ëœ ëª¨ë¸: 17ê°œ (51.5%)
ë™ì¼í•œ ëª¨ë¸: 2ê°œ (3.0%)
í‰ê·  ì„±ëŠ¥ ë³€í™”: -0.29%
```

#### 6.3.2 ìƒìœ„ ê°œì„  ëª¨ë¸
| ìˆœìœ„ | ë°ì´í„°ì…‹ | ì¹´í…Œê³ ë¦¬ | ë³€í™” | ìµœì¢… ì„±ëŠ¥ |
|------|---------|----------|------|-----------|
| 1 | CYP3A4_Substrate_CarbonMangels | Metabolism | +5.47% | 63.78% |
| 2 | BBB_Martins | Distribution | +1.58% | 86.84% |
| 3 | Half_Life_Obach | Excretion | +0.88 MAE | 27.58 MAE |
| 4 | CYP2D6_Veith | Metabolism | +0.72% | 74.23% |
| 5 | PPBR_AZ | Distribution | +0.51 MAE | 9.83 MAE |

#### 6.3.3 í•˜ìœ„ ì•…í™” ëª¨ë¸
| ìˆœìœ„ | ë°ì´í„°ì…‹ | ì¹´í…Œê³ ë¦¬ | ë³€í™” | ìµœì¢… ì„±ëŠ¥ |
|------|---------|----------|------|-----------|
| 1 | CYP1A2_Veith | Metabolism | -6.32% | 77.69% |
| 2 | VDss_Lombardo | Distribution | -4.72 MAE | 0.63 MAE |
| 3 | CYP3A4_Veith | Metabolism | -3.26% | 78.74% |
| 4 | hERG_Central_1uM | Toxicity | -2.48 MAE | 8.08 MAE |
| 5 | Carcinogens_Lagunin | Toxicity | -2.30% | 70.38% |

#### 6.3.4 ë¶„ì„
- **ê°€ì„¤**: Train+Valid ê²°í•© í•™ìŠµì´ ì‘ì€ ë°ì´í„°ì…‹(CYP Substrate)ì—ëŠ” ìœ ë¦¬í•˜ë‚˜, ì˜ íŠœë‹ëœ í° ë°ì´í„°ì…‹ì—ëŠ” ê³¼ì í•© ìœ„í—˜
- **ê°œì„  ë°©ì•ˆ**: ë°ì´í„°ì…‹ í¬ê¸°ë³„ ë‹¤ë¥¸ ì „ëµ ì ìš© í•„ìš”

---

## 7. ë¶„í¬ ë¶„ì„

### 7.1 ì—°ì†í˜• ë°ì´í„°ì…‹ ë¶„í¬ ë³€í™” (KS-test)

#### 7.1.1 ë¶„í¬ ì•ˆì •ì„± ë¶„ë¥˜

**ì•ˆì •ì  ë¶„í¬ (0 shifts)**
- âœ… Clearance_Hepatocyte_AZ
- âœ… Half_Life_Obach
- âœ… hERG_Central_10uM

**ê²½ë¯¸í•œ ë³€í™” (1 shift)**
- Caco2_Wang: train-test shift (p=0.0060)
- PPBR_AZ: train-valid shift (p=0.0296)
- Clearance_Microsome_AZ: train-test shift (p=0.0005)
- hERG_Central_1uM: valid-test shift (p=0.0228)

**ì¤‘ê°„ ë³€í™” (2 shifts)**
- Lipophilicity_AstraZeneca: vs test
- HydrationFreeEnergy_FreeSolv: vs train
- VDss_Lombardo: vs test

**ì‹¬ê°í•œ ë³€í™” (3 shifts)**
- âš ï¸ Solubility_AqSolDB: all pairs (p<0.0001)
- âš ï¸ LD50_Zhu: all pairs (p<0.005)

### 7.2 ë°ì´í„° í’ˆì§ˆ ì´ìŠˆ

#### 7.2.1 ê·¹ë‹¨ì  ì™œë„ (Skewness)
```
VDss_Lombardo: skewness = 27.1 (ê·¹ë‹¨ì  ì´ìƒì¹˜)
  - ìµœëŒ€ê°’: 700.0
  - ì¤‘ì•™ê°’: ~2.5
  - ì œì•ˆ: Log transformation ë˜ëŠ” ì´ìƒì¹˜ ì œê±°

Half_Life_Obach: skewness = 10.3
  - ë²”ìœ„: 0.065 ~ 1200.0
  - ì œì•ˆ: êµ¬ê°„ë³„ ëª¨ë¸ë§ ë˜ëŠ” robust loss

hERG_Central_1uM: skewness = -3.3
  - ì‹¬í•œ ì™¼ìª½ ê¼¬ë¦¬
  - ì œì•ˆ: ë¶„í¬ ì •ê·œí™”
```

#### 7.2.2 ê¶Œì¥ì‚¬í•­
1. **ë¶„í¬ ë³€í™˜**: Log, Box-Cox ë“± ì ìš©
2. **ì´ìƒì¹˜ ì²˜ë¦¬**: Winsorization ë˜ëŠ” í•„í„°ë§
3. **Robust ì†ì‹¤ í•¨ìˆ˜**: Huber loss ë“± ì‹œë„
4. **ì¬ë¶„í• **: Stratified split ê³ ë ¤

---

## 8. ì£¼ìš” ë°œê²¬ì‚¬í•­

### 8.1 ëª¨ë¸ ì„±ëŠ¥

#### 8.1.1 ìš°ìˆ˜í•œ ì„±ëŠ¥
âœ… **Absorption ì˜ˆì¸¡**
- HIA_Hou: 95.88% AUROC (ì‚¬ëŒ ì¥ í¡ìˆ˜)
- PAMPA_NCATS: 90.00% AUROC (ìˆ˜ë™ í™•ì‚°)
- ìš©í•´ë„/ì¹œìœ ì„±: RÂ² > 0.5

âœ… **Toxicity ì˜ˆì¸¡**
- LD50_Zhu: RÂ² 0.62 (ê¸‰ì„± ë…ì„±)
- ClinTox: 88.61% AUROC (ì„ìƒ ë…ì„±)
- hERG ê³„ì—´: í‰ê·  78-80% AUROC

#### 8.1.2 ê°œì„  í•„ìš”
âš ï¸ **CYP Substrate ì˜ˆì¸¡**
- 3ê°œ ëª¨ë¸ ëª¨ë‘ AUROC < 70%
- ì›ì¸: ë°ì´í„° ë¶€ì¡± (ê° ~660ê°œ)
- í•´ê²°ì±…: ë°ì´í„° ì¦ê°• ë˜ëŠ” transfer learning

âš ï¸ **Excretion ì˜ˆì¸¡**
- 3ê°œ ëª¨ë¸ ëª¨ë‘ RÂ² < 0
- ì›ì¸: ë³µì¡í•œ ìƒë¦¬í•™ì  ê³¼ì •, ë°ì´í„° í’ˆì§ˆ
- í•´ê²°ì±…: Multi-task learning, ì¶”ê°€ íŠ¹ì§• ì—”ì§€ë‹ˆì–´ë§

### 8.2 ë°ì´í„° ì¸ì‚¬ì´íŠ¸

#### 8.2.1 ë°ì´í„° í¬ê¸° vs ì„±ëŠ¥
```
ìƒê´€ê´€ê³„ ë¶„ì„:
- í° ë°ì´í„°ì…‹ (>10,000): í‰ê·  AUROC 78-80%
- ì¤‘ê°„ ë°ì´í„°ì…‹ (1,000-10,000): í‰ê·  AUROC 75-85%
- ì‘ì€ ë°ì´í„°ì…‹ (<1,000): í‰ê·  AUROC 60-90% (í¸ì°¨ í¼)

ê²°ë¡ : ë°ì´í„° í¬ê¸°ë³´ë‹¤ í’ˆì§ˆì´ ë” ì¤‘ìš”
```

#### 8.2.2 Task ë‚œì´ë„
```
ì‰¬ì›€ (AUROC > 85%):
  - HIA (ì¥ í¡ìˆ˜)
  - BBB (ë‡Œ íˆ¬ê³¼)
  - ClinTox (ì„ìƒ ë…ì„±)

ë³´í†µ (AUROC 70-85%):
  - CYP inhibition (ëŒ€ì‚¬ ì–µì œ)
  - hERG (ì‹¬ì¥ë…ì„±)
  - AMES (ëŒì—°ë³€ì´)

ì–´ë ¤ì›€ (AUROC < 70%):
  - CYP substrate (ëŒ€ì‚¬ ê¸°ì§ˆ)
  - Carcinogen (ë°œì•”ì„±)
  - Excretion (ë°°ì„¤)
```

### 8.3 í•™ìŠµ ì „ëµ

#### 8.3.1 Combined Training íš¨ê³¼
```
ì¥ì :
  + ì‘ì€ ë°ì´í„°ì…‹ì— íš¨ê³¼ì  (CYP3A4_Substrate: +5.47%)
  + ë” ë§ì€ í•™ìŠµ ë°ì´í„° í™œìš©

ë‹¨ì :
  - ì˜ íŠœë‹ëœ ëª¨ë¸ì— ê³¼ì í•© ìœ„í—˜ (CYP1A2: -6.32%)
  - í‰ê· ì ìœ¼ë¡œ ì†Œí­ ì•…í™” (-0.29%)

ê²°ë¡ : ë°ì´í„°ì…‹ë³„ ë§ì¶¤ ì „ëµ í•„ìš”
```

#### 8.3.2 GPU í™œìš©
```
ê´€ì°°:
  - ì‘ì€ ë°ì´í„°ì…‹: 3-10% GPU ì‚¬ìš©ë¥ 
  - ì¤‘ê°„ ë°ì´í„°ì…‹: 20-40% GPU ì‚¬ìš©ë¥ 
  - í° ë°ì´í„°ì…‹: 50-70% GPU ì‚¬ìš©ë¥ 

ê°œì„  ë°©ì•ˆ:
  - Batch size ì¦ê°€ (ë©”ëª¨ë¦¬ í—ˆìš© ì‹œ)
  - Mixed precision training (FP16)
  - Gradient accumulation
```

---

## 9. ë°°í¬ ì‹œìŠ¤í…œ

### 9.1 í†µí•© ì˜ˆì¸¡ ì‹œìŠ¤í…œ

#### 9.1.1 ì‹œìŠ¤í…œ êµ¬ì¡°
```
ì…ë ¥: SMILES ë¬¸ìì—´
  â†“
[RDKit ë¶„ì ë³€í™˜]
  â†“
[Graph ìƒì„±]
  â†“
[33ê°œ ëª¨ë¸ ë³‘ë ¬ ì˜ˆì¸¡]
  â†“
ì¶œë ¥: 33ê°œ ADMET ì†ì„±
  - ë¶„ë¥˜: í™•ë¥  (0-1)
  - íšŒê·€: ì—°ì†ê°’
```

#### 9.1.2 í•µì‹¬ ê¸°ëŠ¥
```python
from deployment.unified_predictor import ADMETPredictor

# ì´ˆê¸°í™”
predictor = ADMETPredictor()
predictor.load_all_models()  # 33ê°œ ëª¨ë¸ ë¡œë“œ

# ë‹¨ì¼ ì˜ˆì¸¡
results = predictor.predict("CCO")  # Ethanol

# í•œêµ­ì–´ ë¦¬í¬íŠ¸
predictor.print_korean_report("CCO")

# ë°°ì¹˜ ì˜ˆì¸¡
df = predictor.predict_batch(['CCO', 'CC(=O)Oc1ccccc1C(=O)O'])
```

### 9.2 ëª¨ë¸ ì €ì¥ êµ¬ì¡°

#### 9.2.1 ë””ë ‰í† ë¦¬ êµ¬ì¡°
```
workspace/final_models/
â”œâ”€â”€ model_registry.json          # ëª¨ë¸ ë©”íƒ€ë°ì´í„°
â””â”€â”€ hyperparam/
    â”œâ”€â”€ Absorption/
    â”‚   â”œâ”€â”€ Caco2_Wang/final_model/best_model.pt
    â”‚   â”œâ”€â”€ HIA_Hou/final_model/best_model.pt
    â”‚   â””â”€â”€ ...
    â”œâ”€â”€ Distribution/
    â”œâ”€â”€ Metabolism/
    â”œâ”€â”€ Excretion/
    â””â”€â”€ Toxicity/
```

#### 9.2.2 ëª¨ë¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬
```json
{
  "total_models": 33,
  "categories": {...},
  "models": {
    "AMES": {
      "category": "Toxicity",
      "task_type": "classification",
      "metric": "AUROC",
      "model_path": "workspace/final_models/hyperparam/Toxicity/AMES/final_model/best_model.pt"
    },
    ...
  }
}
```

### 9.3 ì‚¬ìš© ì˜ˆì œ

#### 9.3.1 ëª…ë ¹ì¤„ ì‹¤í–‰
```bash
# ë°©ë²• 1: ëª…ë ¹ì¤„ SMILES ì…ë ¥
python workspace/predict.py -s "CCO"

# ë°©ë²• 2: ëŒ€í™”í˜• ëª¨ë“œ
python workspace/predict.py -i

# ë°©ë²• 3: íŒŒì¼ ë‚´ SMILES ìˆ˜ì • í›„ ì‹¤í–‰
# predict.py ìƒë‹¨ì˜ SMILES_INPUT ë³€ìˆ˜ ìˆ˜ì •
python workspace/predict.py
```

#### 9.3.2 Python ìŠ¤í¬ë¦½íŠ¸
```python
import sys
sys.path.insert(0, 'workspace/src')

from deployment.unified_predictor import ADMETPredictor

# ì´ˆê¸°í™”
predictor = ADMETPredictor(verbose=False)
predictor.load_all_models()

# Aspirin ì˜ˆì¸¡
smiles = "CC(=O)Oc1ccccc1C(=O)O"
predictor.print_korean_report(smiles)

# ê²°ê³¼:
# â— Absorption (í¡ìˆ˜)
# Bioavailability_Ma: 51.80% | ìƒë¬¼í•™ì  ì´ìš©ë¥  | ì–‘í˜¸ âœ“
# Caco2_Wang: -4.68 cm/s | Caco2 íˆ¬ê³¼ì„±
# ...
```

---

## 10. í•œê³„ì   

### 10.1 ëª¨ë¸ ì„±ëŠ¥
âš ï¸ **ì¼ë¶€ ì†ì„± ë‚®ì€ ì„±ëŠ¥**
- CYP Substrate: AUROC 57-68%
- Excretion: RÂ² < 0
- ì›ì¸: ë°ì´í„° ë¶€ì¡±, ë³µì¡í•œ ë©”ì»¤ë‹ˆì¦˜

âš ï¸ **Combined Training íš¨ê³¼ ë¯¸ë¯¸**
- í‰ê·  -0.29% ì„±ëŠ¥ ë³€í™”
- ë°ì´í„°ì…‹ë³„ ì°¨ë³„í™” ì „ëµ í•„ìš”

#### 10.2.2 ë°ì´í„° í’ˆì§ˆ
âš ï¸ **ë¶„í¬ ë³€í™” ë° ì´ìƒì¹˜**
- 50% íšŒê·€ ë°ì´í„°ì…‹ì— train-test shift
- VDss, Half_Life ê·¹ë‹¨ì  ì™œë„
- ë°ì´í„° ì •ì œ ë° ë³€í™˜ í•„ìš”

#### 10.2.3 ì¼ë°˜í™” ì„±ëŠ¥
âš ï¸ **Test set ì„±ëŠ¥ ê²€ì¦ í•„ìš”**
- ì™¸ë¶€ ë°ì´í„°ì…‹ ê²€ì¦ ë¯¸ì‹¤ì‹œ
- Domain shift ê°€ëŠ¥ì„±
- Cross-validation ê²°ê³¼ ë¶€ì¬

### 10.4 ìµœì¢… ì˜ê²¬

ë³¸ ì—°êµ¬ëŠ” 33ê°œ ADMET ì†ì„±ì„ ì˜ˆì¸¡í•˜ëŠ” í†µí•© ì‹œìŠ¤í…œì„ ì„±ê³µì ìœ¼ë¡œ êµ¬ì¶•í•˜ì˜€ìœ¼ë©°, íŠ¹íˆ í¡ìˆ˜(Absorption) ë° ë…ì„±(Toxicity) ê´€ë ¨ ì†ì„±ì—ì„œ ìš°ìˆ˜í•œ ì„±ëŠ¥ì„ ë‹¬ì„±í•˜ì˜€ë‹¤. 

ê·¸ëŸ¬ë‚˜ ëŒ€ì‚¬ ê¸°ì§ˆ(CYP Substrate) ë° ë°°ì„¤(Excretion) ê´€ë ¨ ì˜ˆì¸¡ì€ ì¶”ê°€ ê°œì„ ì´ í•„ìš”í•˜ë©°, ì´ëŠ” ë°ì´í„° ë¶€ì¡±ê³¼ ë³µì¡í•œ ìƒë¬¼í•™ì  ë©”ì»¤ë‹ˆì¦˜ì— ê¸°ì¸í•œ ê²ƒìœ¼ë¡œ ë¶„ì„ëœë‹¤.

í–¥í›„ ë°ì´í„° í’ˆì§ˆ ê°œì„ , ëª¨ë¸ ì•„í‚¤í…ì²˜ ìµœì í™”, ë¶ˆí™•ì‹¤ì„± ì •ëŸ‰í™”ë¥¼ í†µí•´ ì‹¤ì œ ì‹ ì•½ ê°œë°œ ê³¼ì •ì— ì ìš© ê°€ëŠ¥í•œ ìˆ˜ì¤€ì˜ ì˜ˆì¸¡ ì‹œìŠ¤í…œìœ¼ë¡œ ë°œì „ì‹œí‚¬ ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ê¸°ëŒ€ëœë‹¤.

---

## ë¶€ë¡

### A. íŒŒì¼ êµ¬ì¡°
```
ADMET/
â”œâ”€â”€ workspace/
â”‚   â”œâ”€â”€ predict.py                    # í†µí•© ì˜ˆì¸¡ ì‹¤í–‰ íŒŒì¼
â”‚   â”œâ”€â”€ FINAL_TRAINING_REPORT.md      # ë³¸ ë³´ê³ ì„œ
â”‚   â”œâ”€â”€ final_training_results.csv    # ì„±ëŠ¥ ê²°ê³¼
â”‚   â”œâ”€â”€ analysis/                     # ë¶„ì„ ê²°ê³¼
â”‚   â”œâ”€â”€ final_models/                 # í•™ìŠµëœ ëª¨ë¸ (33ê°œ)
â”‚   â”œâ”€â”€ data/                         # ì›ë³¸ ë°ì´í„° (4.2GB)
â”‚   â”œâ”€â”€ src/                          # ì†ŒìŠ¤ ì½”ë“œ
â”‚   â”‚   â”œâ”€â”€ loader.py                 # ë°ì´í„° ë¡œë”
â”‚   â”‚   â”œâ”€â”€ main.py                   # í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”‚   â”œâ”€â”€ TopExpert.py              # ëª¨ë¸ ì •ì˜
â”‚   â”‚   â”œâ”€â”€ deployment/               # ë°°í¬ ëª¨ë“ˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ unified_predictor.py  # í†µí•© ì˜ˆì¸¡ê¸°
â”‚   â”‚   â”‚   â””â”€â”€ model_loader.py       # ëª¨ë¸ ë¡œë”
â”‚   â”‚   â”œâ”€â”€ analysis/                 # ë¶„ì„ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”‚   â””â”€â”€ generation/               # ëª…ë ¹ì–´ ìƒì„±
â”‚   â””â”€â”€ archives/                     # ì´ì „ ì‹¤í—˜ ê²°ê³¼
â”œâ”€â”€ configs/
â”‚   â”œâ”€â”€ dataset_config.json           # ë°ì´í„°ì…‹ ì„¤ì •
â”‚   â””â”€â”€ best_hyperparameters_final.json  # ìµœì  í•˜ì´í¼íŒŒë¼ë¯¸í„°
â””â”€â”€ note/
    â””â”€â”€ 20251118_research_report.md   # ì—°êµ¬ ë…¸íŠ¸
```

### B. ì°¸ê³  ë¬¸í—Œ
```
[1] Xu et al. "How Powerful are Graph Neural Networks?" ICLR 2019
[2] Hu et al. "Strategies for Pre-training Graph Neural Networks" ICLR 2020
[3] Wu et al. "MoleculeNet: A Benchmark for Molecular ML" Chem. Sci. 2018
[4] Yang et al. "Analyzing Learned Molecular Representations" J. Chem. Inf. Model. 2019
[5] Veith et al. "Comprehensive characterization of cytochrome P450" Nat. Biotechnol. 2009
```

### C. ì¬í˜„ ë°©ë²•
```bash
# í™˜ê²½ ì„¤ì •
conda create -n ADMET python=3.11
conda activate ADMET
pip install torch==2.8.0 torch-geometric==2.6.1 rdkit

# ëª¨ë¸ í•™ìŠµ (ì˜ˆì‹œ)
python workspace/src/main.py \
  --dataset AMES \
  --batch_size 32 \
  --lr 1e-4 \
  --epochs 100

# í†µí•© ì˜ˆì¸¡
python workspace/predict.py -s "CCO"
```
